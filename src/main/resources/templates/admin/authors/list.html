<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/layouts/default.html}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
  <div layout:fragment="content">
    <table class="table table-hover">
      <thead class="thead-dark">
      <tr>
        <th>STT</th>
        <th>Họ và tên</th>
        <th>Hành động</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="author, index : ${authors}">
        <td th:text="${index.count}"></td>
        <td th:text="${author.getName()}"></td>
        <td>
          <a class="btn btn-sm btn-info mr-1" th:href="@{/admin/authors/{id}(id = ${author.getId()})}">Chi tiết</a>
          <a class="btn btn-sm btn-warning mr-1 update" th:href="@{/admin/authors/{id}/update(id = ${author.id})}">Sửa</a>
          <button class="btn btn-sm btn-danger delete">Xoá</button>
        </td>
      </tr>
      </tbody>
    </table>
    <script>
      $(document).ready(function () {
        $('.delete').click(function () {
          var id = $(this).closest('tr').find('td:eq(0)').text();
          $.ajax({
            url: '/admin/authors/' + id,
            type: 'DELETE',
            success: function (data) {
              alert('Xoá tác giả thành công');
              window.location.reload();
            },
            error: function (error) {
              alert('Xoá tác giả thất bại');
            }
          });
        });
      });
    </script>
  </div>
</body>
</html>